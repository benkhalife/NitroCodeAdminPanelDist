import{h as r,g as o,d as e,f as D,x as z,u as P,r as E,o as O,y as Z,j,z as w,m as _,F as I,l as N,q as T,t as R,b as f,w as $,k as m,A as V,S as q,B as F,e as g,v as k,C as H,c as U,D as K}from"./index-oBUesopq.js";import{_ as L,a as G,b as S,c as J}from"./MetaTags-CPoCo-zI.js";import{_ as Q}from"./TitleBar-DIh_73dU.js";import{u as W}from"./sidebar-C-esjiO9.js";import{r as X}from"./PhotoIcon-_CrP_4NM.js";import{r as Y}from"./TrashIcon-BV0CyXw0.js";import{r as ee}from"./PlusIcon-ZvzyOf1N.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";class te{prevent_default=!0;listen_keys=[];active_timer=!1;timer=1e3;event_type="keydown";timeoutid=null;listeners={};constructor(l){return this.controll_key=l,this}setPreventDefault(l){return this.prevent_default=l,this}setEventType(l="keydown"){return this.event_type=l,this}check(l,u){return!!(l[this.controll_key+"Key"]&&(Array.isArray(u)&&u.indexOf(l.key)>-1||typeof u=="string"&&l.key==u))}runTimer(){this.active_timer==!1&&(this.active_timer=!0,this.timeoutid=setTimeout(()=>{this.active_timer=!1,this.listen_keys=[]},this.timer))}listen(l,u,n){const h=c=>this.action(c,u,n);return this.listeners[l]=h,document.addEventListener(this.event_type,this.listeners[l]),this}listenMulti(l,u,n){const h=c=>this.multiAction(c,[...u,n]);return this.listeners[l]=h,document.addEventListener(this.event_type,this.listeners[l]),this}remove(l){document.removeEventListener(this.event_type,this.listeners[l])}removeAll(){Object.keys(this.listeners).forEach(l=>{this.remove(l)})}action(l,u,n){this.check(l,u)&&(this.prevent_default&&l.preventDefault(),n())}multiAction(l,u=[]){if(l){var n=null;this.runTimer();for(const c of u)if(typeof c=="function"){n=c;continue}else if(l.key.toLowerCase()==this.controll_key){this.prevent_default&&l.preventDefault();continue}else this.check(l,c)&&this.listen_keys.indexOf(l.key)==-1&&(this.prevent_default&&l.preventDefault(),this.listen_keys.push(l.key));if(n==null)throw"callback is not defined";var h=0;for(const c of this.listen_keys)for(const b of u)(Array.isArray(b)&&c.indexOf(c)>-1||typeof b=="string"&&c==b)&&(h+=1);this.listen_keys.length==u.length-1&&h==u.length-1&&(this.listen_keys=[],clearTimeout(this.timeoutid),this.active_timer=!1,n())}}}function se(x,l){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z","clip-rule":"evenodd"})])}function le(x,l){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])}const ie={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},oe={class:"flex justify-between gap-4 items-center"},ne={key:0,class:"border-4 border-dashed border-primary/20 rounded-xl mt-8 text-center p-10 text-xl text-primary/60 font-bold"},ae={key:1},re={key:0,class:"border-4 border-dashed border-primary/20 rounded-xl mt-8 text-center p-10"},de={class:"mt-8 text-center"},ue={class:"flex flex-col gap-4 mt-10"},ce={class:"flex items-center gap-3"},pe={key:0},me={key:1},fe={class:"text-xl"},ve={class:"flex items-center gap-2"},_e=["onClick"],he={__name:"AdminEpisodesListManage",props:{product:{default:{id:0}}},setup(x){const l=new te("alt"),u=D(),n=z(),h=P(),c=E([]),b=x,v=()=>{V.post("admin/product/episodes-list",{product_id:n.params.id}).then(p=>{p.ok&&(c.value=p.episodes)})},s=()=>{const p=u.resolve({name:"admin_product_episode_new",params:{product_id:b.product.id}});window.open(p.href,"_blank")};O(()=>{v(),l.listen("add_episode","a",()=>{s()}),l.listen("reload_episodes","r",()=>{v()})});const C=p=>!(p.publish==!1||p.publish=="0"),A=p=>{q.fire({title:p.title,text:"آیا از حذف این بخش اطمینان دارید؟",icon:"warning",showCancelButton:!0,confirmButtonText:"حذف کن",cancelButtonText:"لغو"}).then(a=>{a.isConfirmed&&M(p)})},M=p=>{V.post("admin/product/episode-remove",{episode_id:p.id}).then(()=>{h.showToast("قسمت با موفقیت حذف شد"),v()})};return Z(()=>{l.removeAll()}),(p,a)=>{const t=j("router-link");return o(),r("div",ie,[e("div",oe,[a[2]||(a[2]=e("div",{class:"text-xl font-bold"},"لیست قسمت های محصول",-1)),e("div",null,[e("button",{onClick:a[0]||(a[0]=d=>s()),class:"btn btn-primary"},"ایجاد قسمت")])]),x.product.id==0||!x.product.id?(o(),r("div",ne,a[3]||(a[3]=[w(" لطفا ابتدا اطلاعات اولیه محصول را ذخیره کنید و سپس به این قسمت مراجعه نمایید "),e("div",{class:"text-primary text-4xl mt-8"},"😅",-1)]))):(o(),r("div",ae,[c.value.length==0?(o(),r("div",re,[a[5]||(a[5]=e("div",{class:"text-xl text-primary/60 font-bold"}," هنوز محتوایی اضافه نشده است ",-1)),e("div",de,[e("button",{onClick:a[1]||(a[1]=d=>s()),class:"btn btn-xl btn-primary"}," افزودن قسمت جدید "),a[4]||(a[4]=e("div",{dir:"ltr",class:"mt-4"},[e("kbd",{class:"kbd"},"alt"),w(" + "),e("kbd",{class:"kbd"},"A")],-1))])])):_("",!0),e("div",ue,[(o(!0),r(I,null,N(c.value,d=>(o(),r("div",{class:T([{"opacity-70":C(d)==!1},"p-4 rounded-xl bg-base-100 flex justify-between items-center"]),key:d.id},[e("div",ce,[C(d)==!1?(o(),r("div",pe,"⚠️")):(o(),r("div",me,"✳️")),e("div",fe,R(d.title),1)]),e("div",ve,[f(t,{target:"_blank",to:{name:"admin_product_episode_edit",params:{product_id:m(n).params.id,episode_id:d.id}},class:"cursor-pointer p-1 hover:scale-105 duration-200 hover:bg-primary/40 rounded-xl text-primary bg-primary/20"},{default:$(()=>[f(m(se),{class:"size-8"})]),_:2},1032,["to"]),e("button",{onClick:i=>A(d),class:"cursor-pointer p-1 hover:scale-105 duration-200 hover:bg-primary/20 rounded-xl text-warning"},[f(m(le),{class:"size-8"})],8,_e)])],2))),128))])]))])}}},ge={role:"tablist",class:"tabs tabs-box mr-auto"},be={key:0,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},ye={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},xe={class:"fieldset"},ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 lg:gap-4"},we={class:"fieldset"},$e={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ve={class:"fieldset"},Ce={class:"fieldset"},Ae={class:""},Te={class:"rounded-lg bg-base-200 p-2 lg:p-4 flex flex-col gap-4 lg:min-w-sm"},Ue={class:"text-center"},Ee={class:"mt-4"},Me=["src"],Be={key:1,class:"mx-auto"},Le={class:"fieldset bg-base-100 border-base-300 rounded-box w-64 border p-4 lg:mt-auto w-full"},Se={class:"label"},De=["checked"],ze={class:"flex flex-wrap gap-2 md:grid-cols-2"},Pe={key:1,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},je={key:2,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},Ie={key:3,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},Ne={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},Oe={class:"flex gap-4 items-end"},Ze={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 flex-1 gap-4 items-center"},Re={class:"col-span-1 sm:col-span-3 md:col-span-1 fieldset flex items-center"},qe=["onUpdate:modelValue"],Fe=["onUpdate:modelValue"],He={class:"col-span-1 fieldset"},Ke=["onUpdate:modelValue"],Ge={class:"col-span-1 fieldset"},Je=["onUpdate:modelValue"],Qe={class:"flex gap-2"},We=["onClick"],nt={__name:"ProductManageView",setup(x){const l=W(),u=P(),n=z(),h=D(),c=async()=>{const a=await V.post("admin/product/info",{id:n.params.id});a.ok&&(s.value=a.product,v.value=a.inventorys,s.value.publish===1||s.value.publish==="1"?s.value.publish=!0:s.value.publish=!1)},b=E(null),v=E([]),s=E({}),C=()=>{v.value.push({name:"",price:0,count:1})};C();const A=async()=>{const a=await V.post("admin/product/save",{...s.value,inventorys:v.value});a.ok&&(u.showToast("عملیات با موفقیت انجام شد!","success"),n.name=="admin_product_new"&&(await h.push({name:"admin_product_edit",params:{id:a.product.id}}),c()))},M=a=>{const t=a.target.files[0];V.uploadFile("admin/product/upload-image",t,{},d=>{console.log(d)},d=>{console.log(d),d.ok&&(s.value.image=d.dir)},d=>{})};n.name=="admin_product_new"?l.setTitle("ایجاد محصول جدید"):(l.setTitle("ویرایش محصول"),c());const p=F(()=>`\`\`\` 
<h1>${s.value.title}</h1> <br> ${s.value.description} 
 \`\`\` 
---
  
`);return(a,t)=>{const d=j("RouterLink");return o(),r("div",null,[f(Q,{title:m(l).getTitle},{default:$(()=>[e("div",ge,[f(d,{to:{hash:""},role:"tab",class:T(["tab",{"tab-active tab-primary":m(n).hash==""}])},{default:$(()=>t[11]||(t[11]=[w(" اطلاعات محصول ")])),_:1,__:[11]},8,["class"]),s.value.content_type=="physical"?(o(),U(d,{key:0,to:{hash:"#inventory"},class:T([{"tab-active ":m(n).hash=="#inventory"},"tab"]),role:"tab"},{default:$(()=>t[12]||(t[12]=[w("موجودی محصول")])),_:1,__:[12]},8,["class"])):_("",!0),f(d,{to:{hash:"#meta"},class:T([{"tab-active":m(n).hash=="#meta"},"tab"]),role:"tab"},{default:$(()=>t[13]||(t[13]=[w("متا تگ‌ها")])),_:1,__:[13]},8,["class"]),s.value.content_type=="course"?(o(),U(d,{key:1,to:{hash:"#episodes"},class:T([{"tab-active":m(n).hash=="#episodes"},"tab"]),role:"tab"},{default:$(()=>t[14]||(t[14]=[w("قسمت های محصول")])),_:1,__:[14]},8,["class"])):_("",!0)])]),_:1},8,["title"]),m(n).hash==""?(o(),r("div",be,[e("div",ye,[e("fieldset",xe,[t[15]||(t[15]=e("legend",{class:"fieldset-legend"},"عنوان محصول",-1)),g(e("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>s.value.title=i),class:"input input-primary w-full",type:"text",placeholder:"عنوان محصول"},null,512),[[k,s.value.title]])]),e("div",ke,[f(L,{title:"لینک محصول","site-domain":"/","ai-use-type":"link_generator","ai-input":s.value.title,modelValue:s.value.link,"onUpdate:modelValue":t[1]||(t[1]=i=>s.value.link=i)},null,8,["ai-input","modelValue"]),e("fieldset",we,[t[17]||(t[17]=e("legend",{class:"fieldset-legend"}," نوع محتوای محصول ",-1)),g(e("select",{"onUpdate:modelValue":t[2]||(t[2]=i=>s.value.content_type=i),class:"select select-primary w-full"},t[16]||(t[16]=[e("option",{value:"physical"},"محتوای فیزیکی",-1),e("option",{value:"course"},"محتوای رسانه/ویدیو/دوره آموزشی",-1)]),512),[[H,s.value.content_type]])])]),s.value.content_type=="course"?(o(),r("div",$e,[e("fieldset",Ve,[t[18]||(t[18]=e("legend",{class:"fieldset-legend"},"قیمت اصلی",-1)),g(e("input",{dir:"ltr","onUpdate:modelValue":t[3]||(t[3]=i=>s.value.price=i),class:"input input-primary w-full",type:"number",placeholder:""},null,512),[[k,s.value.price]])]),e("fieldset",Ce,[t[19]||(t[19]=e("legend",{class:"fieldset-legend"},"قیمت نمایشی (برای تخفیف باید بیشتر از قیمت اصلی باشد)",-1)),g(e("input",{dir:"ltr","onUpdate:modelValue":t[4]||(t[4]=i=>s.value.show_price=i),class:"input input-primary w-full",type:"number",placeholder:""},null,512),[[k,s.value.show_price]])])])):_("",!0),e("div",null,[f(L,{maxlength:140,title:"توضیح کوتاه","ai-use-type":"small_description","ai-input":p.value,modelValue:s.value.small_description,"onUpdate:modelValue":t[5]||(t[5]=i=>s.value.small_description=i)},null,8,["ai-input","modelValue"])]),e("div",Ae,[t[20]||(t[20]=e("legend",{class:"fieldset-legend"},"توضیحات",-1)),(o(),U(G,{key:s.value.id,value:s.value.description,onInput:t[6]||(t[6]=i=>s.value.description=i)},null,8,["value"]))])]),e("div",Te,[e("div",Ue,[e("input",{onChange:M,ref_key:"upload_main_image",ref:b,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",Ee,[s.value.image?(o(),r("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:m(V).server+s.value.image,alt:""},null,8,Me)):(o(),r("div",Be,[f(m(X),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:t[7]||(t[7]=i=>b.value.click())}," آپلود عکس محصول ")]),e("fieldset",Le,[e("label",Se,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=i=>s.value.publish=i),checked:s.value.publish,class:"checkbox checkbox-success"},null,8,De),[[K,s.value.publish]]),t[21]||(t[21]=w(" انتشار محصول "))])]),e("div",ze,[f(S,{"ai-use-type":"seo","ai-input":s.value.description,title:"SEO Check"},null,8,["ai-input"]),f(S,{"ai-use-type":"misspelling","ai-input":s.value.description,title:"Check Misspelling"},null,8,["ai-input"])]),e("div",{class:"text-center"},[e("button",{onClick:A,class:"btn btn-success"}," ذخیره محصول ")])])])):_("",!0),m(n).hash=="#episodes"?(o(),r("div",Pe,[f(he,{product:s.value},null,8,["product"])])):_("",!0),m(n).hash=="#meta"?(o(),r("div",je,[s.value.id?(o(),U(J,{key:0,modelValue:s.value,"onUpdate:modelValue":t[9]||(t[9]=i=>s.value=i),"ai-input":p.value,onSave:t[10]||(t[10]=i=>A())},null,8,["modelValue","ai-input"])):_("",!0)])):_("",!0),m(n).hash=="#inventory"?(o(),r("div",Ie,[e("div",Ne,[t[25]||(t[25]=e("div",{class:"text-xl font-bold"},"موجودی محصول",-1)),(o(!0),r(I,null,N(v.value,(i,B)=>(o(),r("div",Oe,[e("div",Ze,[e("fieldset",Re,[t[22]||(t[22]=e("legend",{class:"fieldset-legend"},"مدل/رنگ",-1)),g(e("input",{class:"color",style:{width:"40px",height:"40px","border-radius":"30px"},type:"color","onUpdate:modelValue":y=>i.color=y},null,8,qe),[[k,i.color]]),g(e("input",{"onUpdate:modelValue":y=>i.name=y,class:"input input-primary w-full"},null,8,Fe),[[k,i.name]])]),e("fieldset",He,[t[23]||(t[23]=e("legend",{class:"fieldset-legend"},"قیمت",-1)),g(e("input",{"onUpdate:modelValue":y=>i.price=y,class:"input input-primary w-full"},null,8,Ke),[[k,i.price]])]),e("fieldset",Ge,[t[24]||(t[24]=e("legend",{class:"fieldset-legend"},"موجودی",-1)),g(e("input",{"onUpdate:modelValue":y=>i.quantity=y,class:"input input-primary w-full"},null,8,Je),[[k,i.quantity]])])]),e("div",Qe,[v.value.length>1?(o(),r("button",{key:0,onClick:y=>v.value.splice(B,1),class:"cursor-pointer p-2 border-error hover:bg-error/20 duration-200 text-error rounded-lg border-1"},[f(m(Y),{class:"size-6"})],8,We)):_("",!0),B==v.value.length-1?(o(),r("button",{key:1,onClick:C,class:"cursor-pointer hover:bg-info/20 duration-200 p-2 rounded-lg border-1"},[f(m(ee),{class:"size-6"})])):_("",!0)])]))),256)),e("div",{class:"text-center"},[e("button",{onClick:A,class:"btn btn-success"}," ذخیره موجودی محصول ")])])])):_("",!0)])}}};export{nt as default};
