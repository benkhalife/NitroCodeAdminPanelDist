import{D as P,s as N,h as i,g as o,m as h,d as e,t as S,q as C,F as $,l as I,c as x,r as M,k as c,A as k,b,u as L,E as A,x as q,w as U,e as z,v as G,z as T,C as O,f as H,j as J,G as K}from"./index-C2QhPaHL.js";import{_ as F}from"./TextEditor-UqgvCB5p.js";import{_ as Q}from"./TitleBar-CeQrJQO6.js";import{u as W}from"./sidebar-B3Xf4WdF.js";import{_ as X}from"./ComInput-BEKEJEHE.js";import{r as R,_ as Y,a as j}from"./AiInput-D4vIGdaK.js";import{r as Z}from"./TrashIcon-B0wb2rIU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"fieldset"},te={key:0,class:"fieldset-legend"},le=["value","placeholder"],se={key:1,class:"label"},ae={__name:"ComTextarea",props:P({title:{default:""},label:{default:"Input"},placeholder:{default:"Type here"},optional:{default:""},textareaClass:{default:""},value:{default:""}},{modelValue:{},modelModifiers:{}}),emits:P(["input"],["update:modelValue"]),setup(u,{emit:p}){const r=u;N(u,"modelValue");const n=p;return(v,d)=>(o(),i("fieldset",ee,[r.title?(o(),i("legend",te,S(r.title),1)):h("",!0),e("textarea",{onInput:d[0]||(d[0]=_=>n("input",_)),value:r.value,class:C([r.textareaClass,"textarea w-full"]),placeholder:r.placeholder},null,42,le),r.optional?(o(),i("p",se,S(r.optional),1)):h("",!0)]))}};function oe(u,p){console.log(u.input.target.value,u.component.key,p),p[u.component.key]=u.input.target.value}const ie={class:"flex flex-col gap-4"},ne={__name:"PluginFormBuilder",props:{variable:{default:{}},plugin:{default:[]}},emits:["changeInput"],setup(u,{emit:p}){const r=p,n=u,v=(d,_)=>{console.log(n.variable,d),oe({input:d,component:_},n.variable),r("changeInput",{input:d,component:_})};return(d,_)=>(o(),i("div",ie,[(o(!0),i($,null,I(n.plugin.getData(),(s,g)=>(o(),i("div",{key:g,class:C(["grid gap-4","grid-cols-"+s.length])},[(o(!0),i($,null,I(s,(a,y)=>(o(),i("div",{key:y},[a.name=="input"?(o(),x(X,{key:0,value:u.variable[a.key],onInput:w=>v(w,a),title:a.props.title,placeholder:a.props?.placeholder,optional:a.props?.optional,"input-class":a?.props?.inputClass},null,8,["value","onInput","title","placeholder","optional","input-class"])):a.name=="textarea"?(o(),x(ae,{key:1,value:u.variable[a.key],onInput:w=>v(w,a),title:a.props.title,placeholder:a.props?.placeholder,optional:a.props?.optional,"textarea-class":a?.props?.textareaClass},null,8,["value","onInput","title","placeholder","optional","textarea-class"])):h("",!0)]))),128))],2))),128))]))}},ue={class:"text-center"},re={class:"mt-4"},de=["src"],ce={key:1,class:"mx-auto"},pe={__name:"SimpleImageUploader",props:P({uploadUrl:{default:""},parrams:{default:{}}},{modelValue:{},modelModifiers:{}}),emits:P(["changeImage","progress","success","error"],["update:modelValue"]),setup(u,{emit:p}){const r=M(null),n=N(u,"modelValue"),v=p,d=u,_=()=>{const g=r.value.files[0];v("changeImage",g),d.uploadUrl&&d?.uploadUrl?.length&&s(g)},s=g=>{k.uploadFile(d.uploadUrl,g,d.parrams,a=>{v("progress",a)},a=>{v("success",a),a.ok&&(n.value=a.dir)},a=>{v("error",a)})};return(g,a)=>(o(),i("div",ue,[e("input",{onChange:_,ref_key:"upload_main_image",ref:r,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",re,[n.value?(o(),i("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:c(k).server+n.value,alt:""},null,8,de)):(o(),i("div",ce,[b(c(R),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:a[0]||(a[0]=y=>r.value.click())}," آپلود عکس محصول ")]))}},me={role:"tablist",class:"tabs tabs-box"},ge={key:0,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},fe={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},ve={class:"fieldset"},_e={class:""},be={class:"rounded-lg bg-base-200 p-2 lg:p-4 flex flex-col gap-4 lg:min-w-sm"},he={class:"text-center"},xe={class:"mt-4"},ke=["src"],ye={key:1,class:"mx-auto"},we={class:"fieldset bg-base-100 border-base-300 rounded-box w-64 border p-4 lg:mt-auto w-full"},Ce={class:"label"},$e=["checked"],Ie={class:"flex flex-wrap gap-2 md:grid-cols-2"},Ve={key:1,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},Ue={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},Te={class:"mt-8 flex flex-col gap-4 lg:gap-8"},Me={class:"pb-2"},Pe=["onClick"],Se={class:"flex flex-wrap gap-4 justify-center bg-gray-500/20 p-4 rounded-xl"},Be={class:"flex gap-4 flex-col w-full mt-4 py-4"},ze={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},De={class:"text-xl font-bold"},Ge={__name:"PostManageView",setup(u){const p=W(),r=L(),n=q(),v=H(),d=async()=>{const m=await k.post("admin/post/info",{id:n.params.id});m.ok&&(s.value=m.post)},_=M(null),s=M({contents:[]}),g=async()=>{const m=await k.post("admin/post/save",{...s.value});m.ok&&(r.showToast("مطلب ذخیره شد!","success"),n.name=="admin_post_new"&&(await v.push({name:"admin_post_edit",params:{id:m.post.id}}),d()))},a=m=>{const t=m.target.files[0];k.uploadFile("admin/post/upload-image",t,{},f=>{console.log(f)},f=>{console.log(f),f.ok&&(console.log(f.dir),s.value.image=f.dir)},f=>{})},y=m=>{const t=new Date().getTime();s.value.contents.push({name:m,id:t})},w=m=>{s.value.contents.splice(m,1)};var D=A.findPluginsByPath("post/manage");n.name=="admin_post_new"?p.setTitle("ایجاد مطلب جدید"):(p.setTitle("ویرایش مطلب"),d());const E=M("https://nitrocode.ir");return(m,t)=>{const f=J("RouterLink");return o(),i("div",null,[b(Q,{title:c(p).getTitle},{default:U(()=>[e("div",me,[b(f,{to:{hash:""},role:"tab",class:C(["tab",{"tab-active tab-primary":c(n).hash==""}])},{default:U(()=>t[7]||(t[7]=[T(" اطلاعات مطلب ")])),_:1,__:[7]},8,["class"]),b(f,{to:{hash:"#contents"},role:"tab",class:C(["tab",{"tab-active tab-primary":c(n).hash=="#contents"}])},{default:U(()=>t[8]||(t[8]=[T(" محتوا ")])),_:1,__:[8]},8,["class"]),(o(!0),i($,null,I(c(D),(l,B)=>(o(),x(f,{key:B,to:{hash:"#"+l.name},class:C([{"tab-active":c(n).hash=="#"+l.name},"tab"]),role:"tab"},{default:U(()=>[T(S(l.title),1)]),_:2},1032,["to","class"]))),128))])]),_:1},8,["title"]),c(n).hash==""?(o(),i("div",ge,[e("div",fe,[e("fieldset",ve,[t[9]||(t[9]=e("legend",{class:"fieldset-legend"},"عنوان",-1)),z(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.title=l),class:"input input-primary w-full",type:"text",placeholder:"عنوان "},null,512),[[G,s.value.title]])]),b(Y,{title:"لینک مطلب","site-domain":`${E.value}/post/`,"ai-use-type":"link_generator","ai-input":s.value.title,modelValue:s.value.link,"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.link=l)},null,8,["site-domain","ai-input","modelValue"]),e("div",_e,[t[10]||(t[10]=e("legend",{class:"fieldset-legend"},"متن مطلب",-1)),(o(),x(F,{key:s.value.id,value:s.value.description,onInput:t[2]||(t[2]=l=>s.value.description=l)},null,8,["value"]))])]),e("div",be,[e("div",he,[e("input",{onChange:a,ref_key:"upload_main_image",ref:_,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",xe,[s.value.image?(o(),i("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:c(k).server+s.value.image,alt:""},null,8,ke)):(o(),i("div",ye,[b(c(R),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:t[3]||(t[3]=l=>_.value.click())}," آپلود عکس مطلب ")]),e("fieldset",we,[e("label",Ce,[z(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.publish=l),type:"checkbox",checked:s.value.publish,class:"checkbox checkbox-success"},null,8,$e),[[O,s.value.publish]]),t[11]||(t[11]=T(" انتشار مطلب "))])]),e("div",Ie,[b(j,{"ai-use-type":"seo","ai-input":s.value.description,title:"SEO Check"},null,8,["ai-input"]),b(j,{"ai-use-type":"misspelling","ai-input":s.value.description,title:"Check Misspelling"},null,8,["ai-input"])]),e("div",{class:"text-center"},[e("button",{onClick:g,class:"btn btn-success"}," ذخیره مطلب ")])])])):h("",!0),c(n).hash=="#contents"?(o(),i("div",Ve,[e("div",Ue,[t[12]||(t[12]=e("div",{class:"text-xl font-bold"},"محتوای مطلب",-1)),e("div",Te,[s.value?.contents?(o(!0),i($,{key:0},I(s.value.contents,(l,B)=>(o(),i("div",{key:l.id,class:"bg-gray-700/30 p-2"},[e("div",Me,[e("button",{onClick:V=>w(B),class:"btn btn-ghost btn-sm"},[b(c(Z),{class:"size-6 text-error"})],8,Pe)]),l?.name=="text"?(o(),x(F,{onInput:V=>l.text=V,value:l.text,key:l.id,"com-id":l.id},null,8,["onInput","value","com-id"])):h("",!0),l?.name=="image"?(o(),x(pe,{"upload-url":"admin/post/upload-image",modelValue:l.url,"onUpdate:modelValue":V=>l.url=V,key:l.id,"com-id":l.id},null,8,["modelValue","onUpdate:modelValue","com-id"])):h("",!0)]))),128)):h("",!0)]),e("div",Se,[e("button",{onClick:t[5]||(t[5]=l=>y("text")),class:"btn btn-outline"}," افزودن متن "),e("button",{onClick:t[6]||(t[6]=l=>y("image")),class:"btn btn-outline"}," افزودن عکس ")]),e("div",{class:"text-center mt-8"},[e("button",{onClick:g,class:"btn btn-success"}," ذخیره محتوای مطلب ")])])])):h("",!0),(o(!0),i($,null,I(c(D),l=>z((o(),i("div",Be,[e("div",ze,[e("div",De,S(l?.title),1),b(ne,{variable:s.value,plugin:l},null,8,["variable","plugin"]),e("div",{class:"text-center mt-8"},[e("button",{onClick:g,class:"btn btn-success"}," ذخیره اطلاعات ")])])],512)),[[K,c(n).hash=="#"+l.name]])),256))])}}};export{Ge as default};
