import{h as r,g as o,d as e,f as L,x as S,u as z,r as A,o as I,y as N,j as D,z as k,m as h,F as P,l as j,q as T,t as O,b as f,w as C,k as c,A as w,S as Z,e as _,v as b,B as R,c as M,C as q}from"./index-qHGizP-0.js";import{_ as F}from"./TextEditor-BXTr2dYt.js";import{_ as H}from"./TitleBar-Dyl1Jvff.js";import{u as K}from"./sidebar-DGkU3f_H.js";import{_ as G,r as J,a as B}from"./AiInput-BRsXRjxE.js";import{r as Q}from"./TrashIcon-CjRe_FmO.js";import{r as W}from"./PlusIcon-D0h-la0C.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";class X{prevent_default=!0;listen_keys=[];active_timer=!1;timer=1e3;event_type="keydown";timeoutid=null;listeners={};constructor(s){return this.controll_key=s,this}setPreventDefault(s){return this.prevent_default=s,this}setEventType(s="keydown"){return this.event_type=s,this}check(s,d){return!!(s[this.controll_key+"Key"]&&(Array.isArray(d)&&d.indexOf(s.key)>-1||typeof d=="string"&&s.key==d))}runTimer(){this.active_timer==!1&&(this.active_timer=!0,this.timeoutid=setTimeout(()=>{this.active_timer=!1,this.listen_keys=[]},this.timer))}listen(s,d,n){const v=u=>this.action(u,d,n);return this.listeners[s]=v,document.addEventListener(this.event_type,this.listeners[s]),this}listenMulti(s,d,n){const v=u=>this.multiAction(u,[...d,n]);return this.listeners[s]=v,document.addEventListener(this.event_type,this.listeners[s]),this}remove(s){document.removeEventListener(this.event_type,this.listeners[s])}removeAll(){Object.keys(this.listeners).forEach(s=>{this.remove(s)})}action(s,d,n){this.check(s,d)&&(this.prevent_default&&s.preventDefault(),n())}multiAction(s,d=[]){if(s){var n=null;this.runTimer();for(const u of d)if(typeof u=="function"){n=u;continue}else if(s.key.toLowerCase()==this.controll_key){this.prevent_default&&s.preventDefault();continue}else this.check(s,u)&&this.listen_keys.indexOf(s.key)==-1&&(this.prevent_default&&s.preventDefault(),this.listen_keys.push(s.key));if(n==null)throw"callback is not defined";var v=0;for(const u of this.listen_keys)for(const g of d)(Array.isArray(g)&&u.indexOf(u)>-1||typeof g=="string"&&u==g)&&(v+=1);this.listen_keys.length==d.length-1&&v==d.length-1&&(this.listen_keys=[],clearTimeout(this.timeoutid),this.active_timer=!1,n())}}}function Y(x,s){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z","clip-rule":"evenodd"})])}function ee(x,s){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])}const te={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},se={class:"flex justify-between gap-4 items-center"},le={key:0,class:"border-4 border-dashed border-primary/20 rounded-xl mt-8 text-center p-10 text-xl text-primary/60 font-bold"},ie={key:1},oe={key:0,class:"border-4 border-dashed border-primary/20 rounded-xl mt-8 text-center p-10"},ne={class:"mt-8 text-center"},ae={class:"flex flex-col gap-4 mt-10"},re={class:"flex items-center gap-3"},de={key:0},ue={key:1},ce={class:"text-xl"},pe={class:"flex items-center gap-2"},fe=["onClick"],me={__name:"AdminEpisodesListManage",props:{product:{default:{id:0}}},setup(x){const s=new X("alt"),d=L(),n=S(),v=z(),u=A([]),g=x,m=()=>{w.post("admin/product/episodes-list",{product_id:n.params.id}).then(a=>{a.ok&&(u.value=a.episodes)})},l=()=>{const a=d.resolve({name:"admin_product_episode_new",params:{product_id:g.product.id}});window.open(a.href,"_blank")};I(()=>{m(),s.listen("add_episode","a",()=>{l()}),s.listen("reload_episodes","r",()=>{m()})});const $=a=>!(a.publish==!1||a.publish=="0"),V=a=>{Z.fire({title:a.title,text:"آیا از حذف این بخش اطمینان دارید؟",icon:"warning",showCancelButton:!0,confirmButtonText:"حذف کن",cancelButtonText:"لغو"}).then(t=>{t.isConfirmed&&U(a)})},U=a=>{w.post("admin/product/episode-remove",{episode_id:a.id}).then(()=>{v.showToast("قسمت با موفقیت حذف شد"),m()})};return N(()=>{s.removeAll()}),(a,t)=>{const p=D("router-link");return o(),r("div",te,[e("div",se,[t[2]||(t[2]=e("div",{class:"text-xl font-bold"},"لیست قسمت های محصول",-1)),e("div",null,[e("button",{onClick:t[0]||(t[0]=i=>l()),class:"btn btn-primary"},"ایجاد قسمت")])]),x.product.id==0||!x.product.id?(o(),r("div",le,t[3]||(t[3]=[k(" لطفا ابتدا اطلاعات اولیه محصول را ذخیره کنید و سپس به این قسمت مراجعه نمایید "),e("div",{class:"text-primary text-4xl mt-8"},"😅",-1)]))):(o(),r("div",ie,[u.value.length==0?(o(),r("div",oe,[t[5]||(t[5]=e("div",{class:"text-xl text-primary/60 font-bold"}," هنوز محتوایی اضافه نشده است ",-1)),e("div",ne,[e("button",{onClick:t[1]||(t[1]=i=>l()),class:"btn btn-xl btn-primary"}," افزودن قسمت جدید "),t[4]||(t[4]=e("div",{dir:"ltr",class:"mt-4"},[e("kbd",{class:"kbd"},"alt"),k(" + "),e("kbd",{class:"kbd"},"A")],-1))])])):h("",!0),e("div",ae,[(o(!0),r(P,null,j(u.value,i=>(o(),r("div",{class:T([{"opacity-70":$(i)==!1},"p-4 rounded-xl bg-base-100 flex justify-between items-center"]),key:i.id},[e("div",re,[$(i)==!1?(o(),r("div",de,"⚠️")):(o(),r("div",ue,"✳️")),e("div",ce,O(i.title),1)]),e("div",pe,[f(p,{target:"_blank",to:{name:"admin_product_episode_edit",params:{product_id:c(n).params.id,episode_id:i.id}},class:"cursor-pointer p-1 hover:scale-105 duration-200 hover:bg-primary/40 rounded-xl text-primary bg-primary/20"},{default:C(()=>[f(c(Y),{class:"size-8"})]),_:2},1032,["to"]),e("button",{onClick:E=>V(i),class:"cursor-pointer p-1 hover:scale-105 duration-200 hover:bg-primary/20 rounded-xl text-warning"},[f(c(ee),{class:"size-8"})],8,fe)])],2))),128))])]))])}}},ve={role:"tablist",class:"tabs tabs-box"},_e={key:0,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},he={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},ge={class:"fieldset"},ye={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 lg:gap-4"},be={class:"fieldset"},xe={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ke={class:"fieldset"},we={class:"fieldset"},$e={class:"fieldset"},Ce={class:""},Ve={class:"rounded-lg bg-base-200 p-2 lg:p-4 flex flex-col gap-4 lg:min-w-sm"},Ae={class:"text-center"},Te={class:"mt-4"},Ue=["src"],Ee={key:1,class:"mx-auto"},Me={class:"fieldset bg-base-100 border-base-300 rounded-box w-64 border p-4 lg:mt-auto w-full"},Be={class:"label"},Le=["checked"],Se={class:"flex flex-wrap gap-2 md:grid-cols-2"},ze={key:1,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},De={key:2,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},Pe={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},je={class:"flex gap-4 items-end"},Ie={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 flex-1 gap-4 items-center"},Ne={class:"col-span-1 sm:col-span-3 md:col-span-1 fieldset flex items-center"},Oe=["onUpdate:modelValue"],Ze=["onUpdate:modelValue"],Re={class:"col-span-1 fieldset"},qe=["onUpdate:modelValue"],Fe={class:"col-span-1 fieldset"},He=["onUpdate:modelValue"],Ke={class:"flex gap-2"},Ge=["onClick"],lt={__name:"ProductManageView",setup(x){const s=K(),d=z(),n=S(),v=L(),u=async()=>{const a=await w.post("admin/product/info",{id:n.params.id});a.ok&&(l.value=a.product,m.value=a.inventorys,l.value.publish===1||l.value.publish==="1"?l.value.publish=!0:l.value.publish=!1)},g=A(null),m=A([]),l=A({}),$=()=>{m.value.push({name:"",price:0,count:1})};$();const V=async()=>{const a=await w.post("admin/product/save",{...l.value,inventorys:m.value});a.ok&&(d.showToast("عملیات با موفقیت انجام شد!","success"),n.name=="admin_product_new"&&(await v.push({name:"admin_product_edit",params:{id:a.product.id}}),u()))},U=a=>{const t=a.target.files[0];w.uploadFile("admin/product/upload-image",t,{},p=>{console.log(p)},p=>{console.log(p),p.ok&&(l.value.image=p.dir)},p=>{})};return n.name=="admin_product_new"?s.setTitle("ایجاد محصول جدید"):(s.setTitle("ویرایش محصول"),u()),(a,t)=>{const p=D("RouterLink");return o(),r("div",null,[f(H,{title:c(s).getTitle},{default:C(()=>[e("div",ve,[f(p,{to:{hash:""},role:"tab",class:T(["tab",{"tab-active tab-primary":c(n).hash==""}])},{default:C(()=>t[9]||(t[9]=[k(" اطلاعات محصول ")])),_:1,__:[9]},8,["class"]),l.value.content_type=="physical"?(o(),M(p,{key:0,to:{hash:"#inventory"},class:T([{"tab-active ":c(n).hash=="#inventory"},"tab"]),role:"tab"},{default:C(()=>t[10]||(t[10]=[k("موجودی محصول")])),_:1,__:[10]},8,["class"])):h("",!0),l.value.content_type=="course"?(o(),M(p,{key:1,to:{hash:"#episodes"},class:T([{"tab-active":c(n).hash=="#episodes"},"tab"]),role:"tab"},{default:C(()=>t[11]||(t[11]=[k("قسمت های محصول")])),_:1,__:[11]},8,["class"])):h("",!0)])]),_:1},8,["title"]),c(n).hash==""?(o(),r("div",_e,[e("div",he,[e("fieldset",ge,[t[12]||(t[12]=e("legend",{class:"fieldset-legend"},"عنوان محصول",-1)),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>l.value.title=i),class:"input input-primary w-full",type:"text",placeholder:"عنوان محصول"},null,512),[[b,l.value.title]])]),e("div",ye,[f(G,{title:"لینک محصول","site-domain":"/","ai-use-type":"link_generator","ai-input":l.value.title,modelValue:l.value.link,"onUpdate:modelValue":t[1]||(t[1]=i=>l.value.link=i)},null,8,["ai-input","modelValue"]),e("fieldset",be,[t[14]||(t[14]=e("legend",{class:"fieldset-legend"}," نوع محتوای محصول ",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=i=>l.value.content_type=i),class:"select select-primary w-full"},t[13]||(t[13]=[e("option",{value:"physical"},"محتوای فیزیکی",-1),e("option",{value:"course"},"محتوای رسانه/ویدیو/دوره آموزشی",-1)]),512),[[R,l.value.content_type]])])]),l.value.content_type=="course"?(o(),r("div",xe,[e("fieldset",ke,[t[15]||(t[15]=e("legend",{class:"fieldset-legend"},"قیمت اصلی",-1)),_(e("input",{dir:"ltr","onUpdate:modelValue":t[3]||(t[3]=i=>l.value.price=i),class:"input input-primary w-full",type:"number",placeholder:""},null,512),[[b,l.value.price]])]),e("fieldset",we,[t[16]||(t[16]=e("legend",{class:"fieldset-legend"},"قیمت نمایشی (برای تخفیف باید بیشتر از قیمت اصلی باشد)",-1)),_(e("input",{dir:"ltr","onUpdate:modelValue":t[4]||(t[4]=i=>l.value.show_price=i),class:"input input-primary w-full",type:"number",placeholder:""},null,512),[[b,l.value.show_price]])])])):h("",!0),e("div",null,[e("fieldset",$e,[t[17]||(t[17]=e("legend",{class:"fieldset-legend"},"توضیحات کوتاه",-1)),_(e("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>l.value.small_description=i),class:"input input-primary w-full",type:"text",placeholder:""},null,512),[[b,l.value.small_description]])])]),e("div",Ce,[t[18]||(t[18]=e("legend",{class:"fieldset-legend"},"توضیحات",-1)),(o(),M(F,{key:l.value.id,value:l.value.description,onInput:t[6]||(t[6]=i=>l.value.description=i)},null,8,["value"]))])]),e("div",Ve,[e("div",Ae,[e("input",{onChange:U,ref_key:"upload_main_image",ref:g,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",Te,[l.value.image?(o(),r("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:c(w).server+l.value.image,alt:""},null,8,Ue)):(o(),r("div",Ee,[f(c(J),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:t[7]||(t[7]=i=>g.value.click())}," آپلود عکس محصول ")]),e("fieldset",Me,[e("label",Be,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=i=>l.value.publish=i),checked:l.value.publish,class:"checkbox checkbox-success"},null,8,Le),[[q,l.value.publish]]),t[19]||(t[19]=k(" انتشار محصول "))])]),e("div",Se,[f(B,{"ai-use-type":"seo","ai-input":l.value.description,title:"SEO Check"},null,8,["ai-input"]),f(B,{"ai-use-type":"misspelling","ai-input":l.value.description,title:"Check Misspelling"},null,8,["ai-input"])]),e("div",{class:"text-center"},[e("button",{onClick:V,class:"btn btn-success"}," ذخیره محصول ")])])])):h("",!0),c(n).hash=="#episodes"?(o(),r("div",ze,[f(me,{product:l.value},null,8,["product"])])):h("",!0),c(n).hash=="#inventory"?(o(),r("div",De,[e("div",Pe,[t[23]||(t[23]=e("div",{class:"text-xl font-bold"},"موجودی محصول",-1)),(o(!0),r(P,null,j(m.value,(i,E)=>(o(),r("div",je,[e("div",Ie,[e("fieldset",Ne,[t[20]||(t[20]=e("legend",{class:"fieldset-legend"},"مدل/رنگ",-1)),_(e("input",{class:"color",style:{width:"40px",height:"40px","border-radius":"30px"},type:"color","onUpdate:modelValue":y=>i.color=y},null,8,Oe),[[b,i.color]]),_(e("input",{"onUpdate:modelValue":y=>i.name=y,class:"input input-primary w-full"},null,8,Ze),[[b,i.name]])]),e("fieldset",Re,[t[21]||(t[21]=e("legend",{class:"fieldset-legend"},"قیمت",-1)),_(e("input",{"onUpdate:modelValue":y=>i.price=y,class:"input input-primary w-full"},null,8,qe),[[b,i.price]])]),e("fieldset",Fe,[t[22]||(t[22]=e("legend",{class:"fieldset-legend"},"موجودی",-1)),_(e("input",{"onUpdate:modelValue":y=>i.quantity=y,class:"input input-primary w-full"},null,8,He),[[b,i.quantity]])])]),e("div",Ke,[m.value.length>1?(o(),r("button",{key:0,onClick:y=>m.value.splice(E,1),class:"cursor-pointer p-2 border-error hover:bg-error/20 duration-200 text-error rounded-lg border-1"},[f(c(Q),{class:"size-6"})],8,Ge)):h("",!0),E==m.value.length-1?(o(),r("button",{key:1,onClick:$,class:"cursor-pointer hover:bg-info/20 duration-200 p-2 rounded-lg border-1"},[f(c(W),{class:"size-6"})])):h("",!0)])]))),256)),e("div",{class:"text-center"},[e("button",{onClick:V,class:"btn btn-success"}," ذخیره موجودی محصول ")])])])):h("",!0)])}}};export{lt as default};
