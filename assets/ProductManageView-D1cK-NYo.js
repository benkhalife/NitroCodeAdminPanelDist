import{l as L,e as V,m as N,P as R,p as q,c as i,b as m,h as f,w as v,u as a,d as e,q as u,v as g,s as F,a as h,A as x,x as _,y as A,F as C,g as U,k as D,f as E,o,n as y,t as S,z as j,B as G}from"./index-pAN-zCiv.js";import{_ as H,r as J,a as K}from"./PluginFormBuilder-9LGSDlNR.js";import{_ as O}from"./TitleBar-CkT74Jdm.js";import{u as Q}from"./sidebar-CifeiDVe.js";import{r as W}from"./TrashIcon-BoOXbKVO.js";import{r as X}from"./PlusIcon-haIce8lZ.js";import"./ComInput-CHvPmc12.js";const Y={role:"tablist",class:"tabs tabs-box"},Z={key:0,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},ee={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},se={class:"fieldset"},te={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 lg:gap-4"},le={class:"fieldset"},oe={class:"fieldset"},ae={class:""},ne={class:"rounded-lg bg-base-200 p-2 lg:p-4 flex flex-col gap-4 lg:min-w-sm"},ie={class:"text-center"},de={class:"mt-4"},re=["src"],ue={key:1,class:"mx-auto"},ce={class:"fieldset bg-base-100 border-base-300 rounded-box w-64 border p-4 lg:mt-auto w-full"},pe={class:"label"},me=["checked"],fe={key:1,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},ge={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},ve={class:"flex gap-4 items-end"},_e={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 flex-1 gap-4 items-center"},be={class:"col-span-1 sm:col-span-3 md:col-span-1 fieldset flex items-center"},he=["onUpdate:modelValue"],xe=["onUpdate:modelValue"],ye={class:"col-span-1 fieldset"},ke=["onUpdate:modelValue"],we={class:"col-span-1 fieldset"},Ve=["onUpdate:modelValue"],Ce={class:"flex gap-2"},Ue=["onClick"],Pe={class:"flex gap-4 flex-col w-full mt-4 py-4"},Te={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},$e={class:"text-xl font-bold"},qe={__name:"ProductManageView",setup(Be){const k=Q(),z=L(),r=q(),M=D(),P=async()=>{const d=await x.post("admin/product/info",{id:r.params.id});d.ok&&(l.value=d.product,p.value=d.inventorys)},T=V(null),p=V([]),l=V({});N(()=>l.value.title,d=>{l.value.link=G(d)});const $=()=>{p.value.push({name:"",price:0,count:1})};$();const w=async()=>{const d=await x.post("admin/product/save",{...l.value,inventorys:p.value});d.ok&&(z.showToast("عملیات با موفقیت انجام شد!","success"),r.name=="admin_product_new"&&(await M.push({name:"admin_product_edit",params:{id:d.product.id}}),P()))},I=d=>{const s=d.target.files[0];x.uploadFile("admin/product/upload-image",s,{},n=>{console.log(n)},n=>{console.log(n),n.ok&&(console.log(n.dir),l.value.image=n.dir)},n=>{})};var B=R.findPluginsByPath("product/manage");return r.name=="admin_product_new"?k.setTitle("ایجاد محصول جدید"):(k.setTitle("ویرایش محصول"),P()),(d,s)=>{const n=E("RouterLink");return o(),i("div",null,[m(O,{title:a(k).getTitle},{default:v(()=>[e("div",Y,[m(n,{to:{hash:""},role:"tab",class:y(["tab",{"tab-active tab-primary":a(r).hash==""}])},{default:v(()=>s[6]||(s[6]=[_(" اطلاعات محصول ")])),_:1,__:[6]},8,["class"]),l.value.content_type=="physical"?(o(),h(n,{key:0,to:{hash:"#inventory"},class:y([{"tab-active ":a(r).hash=="#inventory"},"tab"]),role:"tab"},{default:v(()=>s[7]||(s[7]=[_("موجودی محصول")])),_:1,__:[7]},8,["class"])):f("",!0),l.value.content_type=="media"?(o(),h(n,{key:1,to:{hash:"#courses"},class:y([{"tab-active":a(r).hash=="#courses"},"tab"]),role:"tab"},{default:v(()=>s[8]||(s[8]=[_("دوره های محصول")])),_:1,__:[8]},8,["class"])):f("",!0),(o(!0),i(C,null,U(a(B),(t,b)=>(o(),h(n,{key:b,to:{hash:"#"+t.name},class:y([{"tab-active":a(r).hash=="#"+t.name},"tab"]),role:"tab"},{default:v(()=>[_(S(t.title),1)]),_:2},1032,["to","class"]))),128))])]),_:1},8,["title"]),a(r).hash==""?(o(),i("div",Z,[e("div",ee,[e("fieldset",se,[s[9]||(s[9]=e("legend",{class:"fieldset-legend"},"عنوان محصول",-1)),u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>l.value.title=t),class:"input input-primary w-full",type:"text",placeholder:"عنوان محصول"},null,512),[[g,l.value.title]])]),e("div",te,[e("fieldset",le,[s[10]||(s[10]=e("legend",{class:"fieldset-legend"},"لینک محصول",-1)),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>l.value.link=t),class:"input input-primary w-full",type:"text",placeholder:"لینک محصول"},null,512),[[g,l.value.link]])]),e("fieldset",oe,[s[12]||(s[12]=e("legend",{class:"fieldset-legend"}," نوع محتوای محصول ",-1)),u(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>l.value.content_type=t),class:"select select-primary w-full"},s[11]||(s[11]=[e("option",{value:"physical"},"محتوای فیزیکی",-1),e("option",{value:"media"},"محتوای رسانه/ویدیو",-1)]),512),[[F,l.value.content_type]])])]),e("div",ae,[s[13]||(s[13]=e("legend",{class:"fieldset-legend"},"توضیحات",-1)),(o(),h(H,{key:l.value.id,value:l.value.description,onInput:s[3]||(s[3]=t=>l.value.description=t)},null,8,["value"]))])]),e("div",ne,[e("div",ie,[e("input",{onChange:I,ref_key:"upload_main_image",ref:T,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",de,[l.value.image?(o(),i("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:a(x).server+l.value.image,alt:""},null,8,re)):(o(),i("div",ue,[m(a(J),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:s[4]||(s[4]=t=>T.value.click())}," آپلود عکس محصول ")]),e("fieldset",ce,[e("label",pe,[u(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>l.value.publish=t),type:"checkbox",checked:l.value.publish,class:"checkbox checkbox-success"},null,8,me),[[A,l.value.publish]]),s[14]||(s[14]=_(" انتشار محصول "))])]),e("div",{class:"text-center"},[e("button",{onClick:w,class:"btn btn-success"}," ذخیره محصول ")])])])):f("",!0),a(r).hash=="#inventory"?(o(),i("div",fe,[e("div",ge,[s[18]||(s[18]=e("div",{class:"text-xl font-bold"},"موجودی محصول",-1)),(o(!0),i(C,null,U(p.value,(t,b)=>(o(),i("div",ve,[e("div",_e,[e("fieldset",be,[s[15]||(s[15]=e("legend",{class:"fieldset-legend"},"مدل/رنگ",-1)),u(e("input",{class:"color",style:{width:"40px",height:"40px","border-radius":"30px"},type:"color","onUpdate:modelValue":c=>t.color=c},null,8,he),[[g,t.color]]),u(e("input",{"onUpdate:modelValue":c=>t.name=c,class:"input input-primary w-full"},null,8,xe),[[g,t.name]])]),e("fieldset",ye,[s[16]||(s[16]=e("legend",{class:"fieldset-legend"},"قیمت",-1)),u(e("input",{"onUpdate:modelValue":c=>t.price=c,class:"input input-primary w-full"},null,8,ke),[[g,t.price]])]),e("fieldset",we,[s[17]||(s[17]=e("legend",{class:"fieldset-legend"},"موجودی",-1)),u(e("input",{"onUpdate:modelValue":c=>t.quantity=c,class:"input input-primary w-full"},null,8,Ve),[[g,t.quantity]])])]),e("div",Ce,[p.value.length>1?(o(),i("button",{key:0,onClick:c=>p.value.splice(b,1),class:"cursor-pointer p-2 border-error hover:bg-error/20 duration-200 text-error rounded-lg border-1"},[m(a(W),{class:"size-6"})],8,Ue)):f("",!0),b==p.value.length-1?(o(),i("button",{key:1,onClick:$,class:"cursor-pointer hover:bg-info/20 duration-200 p-2 rounded-lg border-1"},[m(a(X),{class:"size-6"})])):f("",!0)])]))),256)),e("div",{class:"text-center"},[e("button",{onClick:w,class:"btn btn-success"}," ذخیره موجودی محصول ")])])])):f("",!0),(o(!0),i(C,null,U(a(B),t=>u((o(),i("div",Pe,[e("div",Te,[e("div",$e,S(t?.title),1),m(K,{variable:l.value,plugin:t},null,8,["variable","plugin"]),e("div",{class:"text-center mt-8"},[e("button",{onClick:w,class:"btn btn-success"}," ذخیره اطلاعات ")])])],512)),[[j,a(r).hash=="#"+t.name]])),256))])}}};export{qe as default};
