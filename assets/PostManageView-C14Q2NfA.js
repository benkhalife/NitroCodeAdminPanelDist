import{D as M,s as L,h as i,g as o,m as b,d as e,t as S,q as C,F as I,l as $,c as h,r as z,k as p,A as k,b as x,u as R,E as A,G as E,x as q,w as U,e as P,v as F,z as T,C as G,f as H,j as J,H as K,P as O}from"./index-DFEHhRVU.js";import{_ as j}from"./TextEditor-CD1Lxf7F.js";import{_ as Q}from"./TitleBar-Cmt-vUdp.js";import{u as W}from"./sidebar-VPZrFHnp.js";import{_ as X}from"./ComInput-DWhETNCd.js";import{r as N}from"./PhotoIcon-CJS54Kpv.js";import{r as Y}from"./TrashIcon-DIJ8qE39.js";const Z={class:"fieldset"},ee={key:0,class:"fieldset-legend"},te=["value","placeholder"],le={key:1,class:"label"},se={__name:"ComTextarea",props:M({title:{default:""},label:{default:"Input"},placeholder:{default:"Type here"},optional:{default:""},textareaClass:{default:""},value:{default:""}},{modelValue:{},modelModifiers:{}}),emits:M(["input"],["update:modelValue"]),setup(u,{emit:m}){const r=u;L(u,"modelValue");const n=m;return(v,d)=>(o(),i("fieldset",Z,[r.title?(o(),i("legend",ee,S(r.title),1)):b("",!0),e("textarea",{onInput:d[0]||(d[0]=_=>n("input",_)),value:r.value,class:C([r.textareaClass,"textarea w-full"]),placeholder:r.placeholder},null,42,te),r.optional?(o(),i("p",le,S(r.optional),1)):b("",!0)]))}};function ae(u,m){console.log(u.input.target.value,u.component.key,m),m[u.component.key]=u.input.target.value}const oe={class:"flex flex-col gap-4"},ie={__name:"PluginFormBuilder",props:{variable:{default:{}},plugin:{default:[]}},emits:["changeInput"],setup(u,{emit:m}){const r=m,n=u,v=(d,_)=>{console.log(n.variable,d),ae({input:d,component:_},n.variable),r("changeInput",{input:d,component:_})};return(d,_)=>(o(),i("div",oe,[(o(!0),i(I,null,$(n.plugin.getData(),(s,g)=>(o(),i("div",{key:g,class:C(["grid gap-4","grid-cols-"+s.length])},[(o(!0),i(I,null,$(s,(a,y)=>(o(),i("div",{key:y},[a.name=="input"?(o(),h(X,{key:0,value:u.variable[a.key],onInput:w=>v(w,a),title:a.props.title,placeholder:a.props?.placeholder,optional:a.props?.optional,"input-class":a?.props?.inputClass},null,8,["value","onInput","title","placeholder","optional","input-class"])):a.name=="textarea"?(o(),h(se,{key:1,value:u.variable[a.key],onInput:w=>v(w,a),title:a.props.title,placeholder:a.props?.placeholder,optional:a.props?.optional,"textarea-class":a?.props?.textareaClass},null,8,["value","onInput","title","placeholder","optional","textarea-class"])):b("",!0)]))),128))],2))),128))]))}},ne={class:"text-center"},ue={class:"mt-4"},re=["src"],de={key:1,class:"mx-auto"},ce={__name:"SimpleImageUploader",props:M({uploadUrl:{default:""},parrams:{default:{}}},{modelValue:{},modelModifiers:{}}),emits:M(["changeImage","progress","success","error"],["update:modelValue"]),setup(u,{emit:m}){const r=z(null),n=L(u,"modelValue"),v=m,d=u,_=()=>{const g=r.value.files[0];v("changeImage",g),d.uploadUrl&&d?.uploadUrl?.length&&s(g)},s=g=>{k.uploadFile(d.uploadUrl,g,d.parrams,a=>{v("progress",a)},a=>{v("success",a),a.ok&&(n.value=a.dir)},a=>{v("error",a)})};return(g,a)=>(o(),i("div",ne,[e("input",{onChange:_,ref_key:"upload_main_image",ref:r,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",ue,[n.value?(o(),i("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:p(k).server+n.value,alt:""},null,8,re)):(o(),i("div",de,[x(p(N),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:a[0]||(a[0]=y=>r.value.click())}," آپلود عکس محصول ")]))}},pe={role:"tablist",class:"tabs tabs-box"},me={key:0,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},ge={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},fe={class:"fieldset"},ve={class:"fieldset"},_e={class:""},be={class:"rounded-lg bg-base-200 p-2 lg:p-4 flex flex-col gap-4 lg:min-w-sm"},xe={class:"text-center"},he={class:"mt-4"},ke=["src"],ye={key:1,class:"mx-auto"},we={class:"fieldset bg-base-100 border-base-300 rounded-box w-64 border p-4 lg:mt-auto w-full"},Ce={class:"label"},Ie=["checked"],$e={key:1,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},Ve={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},Ue={class:"mt-8 flex flex-col gap-4 lg:gap-8"},Pe={class:"pb-2"},Te=["onClick"],Me={class:"flex flex-wrap gap-4 justify-center bg-gray-500/20 p-4 rounded-xl"},Se={class:"flex gap-4 flex-col w-full mt-4 py-4"},Be={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},ze={class:"text-xl font-bold"},Ee={__name:"PostManageView",setup(u){const m=W(),r=R(),n=q(),v=H(),d=async()=>{const c=await k.post("admin/post/info",{id:n.params.id});c.ok&&(s.value=c.post)},_=z(null),s=z({contents:[]});A(()=>s.value.title,c=>{s.value.link=O(c)});const g=async()=>{const c=await k.post("admin/post/save",{...s.value});c.ok&&(r.showToast("مطلب ذخیره شد!","success"),n.name=="admin_post_new"&&(await v.push({name:"admin_post_edit",params:{id:c.post.id}}),d()))},a=c=>{const t=c.target.files[0];k.uploadFile("admin/post/upload-image",t,{},f=>{console.log(f)},f=>{console.log(f),f.ok&&(console.log(f.dir),s.value.image=f.dir)},f=>{})},y=c=>{const t=new Date().getTime();s.value.contents.push({name:c,id:t})},w=c=>{s.value.contents.splice(c,1)};var D=E.findPluginsByPath("post/manage");return n.name=="admin_post_new"?m.setTitle("ایجاد مطلب جدید"):(m.setTitle("ویرایش مطلب"),d()),(c,t)=>{const f=J("RouterLink");return o(),i("div",null,[x(Q,{title:p(m).getTitle},{default:U(()=>[e("div",pe,[x(f,{to:{hash:""},role:"tab",class:C(["tab",{"tab-active tab-primary":p(n).hash==""}])},{default:U(()=>t[7]||(t[7]=[T(" اطلاعات مطلب ")])),_:1,__:[7]},8,["class"]),x(f,{to:{hash:"#contents"},role:"tab",class:C(["tab",{"tab-active tab-primary":p(n).hash=="#contents"}])},{default:U(()=>t[8]||(t[8]=[T(" محتوا ")])),_:1,__:[8]},8,["class"]),(o(!0),i(I,null,$(p(D),(l,B)=>(o(),h(f,{key:B,to:{hash:"#"+l.name},class:C([{"tab-active":p(n).hash=="#"+l.name},"tab"]),role:"tab"},{default:U(()=>[T(S(l.title),1)]),_:2},1032,["to","class"]))),128))])]),_:1},8,["title"]),p(n).hash==""?(o(),i("div",me,[e("div",ge,[e("fieldset",fe,[t[9]||(t[9]=e("legend",{class:"fieldset-legend"},"عنوان",-1)),P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.title=l),class:"input input-primary w-full",type:"text",placeholder:"عنوان "},null,512),[[F,s.value.title]])]),e("fieldset",ve,[t[10]||(t[10]=e("legend",{class:"fieldset-legend"},"لینک",-1)),P(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.link=l),class:"input input-primary w-full",type:"text",placeholder:"لینک "},null,512),[[F,s.value.link]])]),e("div",_e,[t[11]||(t[11]=e("legend",{class:"fieldset-legend"},"متن مطلب",-1)),(o(),h(j,{key:s.value.id,value:s.value.description,onInput:t[2]||(t[2]=l=>s.value.description=l)},null,8,["value"]))])]),e("div",be,[e("div",xe,[e("input",{onChange:a,ref_key:"upload_main_image",ref:_,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",he,[s.value.image?(o(),i("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:p(k).server+s.value.image,alt:""},null,8,ke)):(o(),i("div",ye,[x(p(N),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:t[3]||(t[3]=l=>_.value.click())}," آپلود عکس مطلب ")]),e("fieldset",we,[e("label",Ce,[P(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.publish=l),type:"checkbox",checked:s.value.publish,class:"checkbox checkbox-success"},null,8,Ie),[[G,s.value.publish]]),t[12]||(t[12]=T(" انتشار مطلب "))])]),e("div",{class:"text-center"},[e("button",{onClick:g,class:"btn btn-success"}," ذخیره مطلب ")])])])):b("",!0),p(n).hash=="#contents"?(o(),i("div",$e,[e("div",Ve,[t[13]||(t[13]=e("div",{class:"text-xl font-bold"},"محتوای مطلب",-1)),e("div",Ue,[s.value?.contents?(o(!0),i(I,{key:0},$(s.value.contents,(l,B)=>(o(),i("div",{key:l.id,class:"bg-gray-700/30 p-2"},[e("div",Pe,[e("button",{onClick:V=>w(B),class:"btn btn-ghost btn-sm"},[x(p(Y),{class:"size-6 text-error"})],8,Te)]),l?.name=="text"?(o(),h(j,{onInput:V=>l.text=V,value:l.text,key:l.id,"com-id":l.id},null,8,["onInput","value","com-id"])):b("",!0),l?.name=="image"?(o(),h(ce,{"upload-url":"admin/post/upload-image",modelValue:l.url,"onUpdate:modelValue":V=>l.url=V,key:l.id,"com-id":l.id},null,8,["modelValue","onUpdate:modelValue","com-id"])):b("",!0)]))),128)):b("",!0)]),e("div",Me,[e("button",{onClick:t[5]||(t[5]=l=>y("text")),class:"btn btn-outline"}," افزودن متن "),e("button",{onClick:t[6]||(t[6]=l=>y("image")),class:"btn btn-outline"}," افزودن عکس ")]),e("div",{class:"text-center mt-8"},[e("button",{onClick:g,class:"btn btn-success"}," ذخیره محتوای مطلب ")])])])):b("",!0),(o(!0),i(I,null,$(p(D),l=>P((o(),i("div",Se,[e("div",Be,[e("div",ze,S(l?.title),1),x(ie,{variable:s.value,plugin:l},null,8,["variable","plugin"]),e("div",{class:"text-center mt-8"},[e("button",{onClick:g,class:"btn btn-success"}," ذخیره اطلاعات ")])])],512)),[[K,p(n).hash=="#"+l.name]])),256))])}}};export{Ee as default};
