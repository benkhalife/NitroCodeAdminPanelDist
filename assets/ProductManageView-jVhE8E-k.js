import{u as L,r as V,x as N,P as R,y as q,h as i,b as g,m as f,w as v,k as o,d as e,e as n,v as p,z as D,c as h,A as x,B as b,C as E,F as C,l as U,f as F,j,g as a,q as y,t as S,D as A,E as G}from"./index-WgpEt6N9.js";import{_ as H,r as J,a as K}from"./PluginFormBuilder-BVMsLnab.js";import{_ as O}from"./TitleBar-DlQArSd_.js";import{u as Q}from"./sidebar-HwEejmSs.js";import{r as W}from"./TrashIcon-B579-Ga4.js";import{r as X}from"./PlusIcon-SvLRtKwc.js";import"./ComInput-Cfhc8fGX.js";const Y={role:"tablist",class:"tabs tabs-box"},Z={key:0,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},ee={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},le={class:"fieldset"},se={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 lg:gap-4"},te={class:"fieldset"},ae={class:"fieldset"},oe={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"fieldset"},ne={class:"fieldset"},de={class:"fieldset"},ue={class:""},re={class:"rounded-lg bg-base-200 p-2 lg:p-4 flex flex-col gap-4 lg:min-w-sm"},pe={class:"text-center"},ce={class:"mt-4"},me=["src"],fe={key:1,class:"mx-auto"},ge={class:"fieldset bg-base-100 border-base-300 rounded-box w-64 border p-4 lg:mt-auto w-full"},ve={class:"label"},be=["checked"],_e={key:1,class:"flex gap-4 lg:items-start flex-col lg:flex-row w-full mt-4 py-4"},he={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},xe={class:"flex gap-4 items-end"},ye={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 flex-1 gap-4 items-center"},ke={class:"col-span-1 sm:col-span-3 md:col-span-1 fieldset flex items-center"},we=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],Ce={class:"col-span-1 fieldset"},Ue=["onUpdate:modelValue"],Pe={class:"col-span-1 fieldset"},Te=["onUpdate:modelValue"],$e={class:"flex gap-2"},Be=["onClick"],Se={class:"flex gap-4 flex-col w-full mt-4 py-4"},ze={class:"w-full flex flex-col gap-4 rounded-lg bg-base-200 p-2 lg:p-4"},Me={class:"text-xl font-bold"},je={__name:"ProductManageView",setup(Ie){const k=Q(),z=L(),r=q(),M=F(),P=async()=>{const d=await x.post("admin/product/info",{id:r.params.id});d.ok&&(s.value=d.product,m.value=d.inventorys,s.value.publish===1||s.value.publish==="1"?s.value.publish=!0:s.value.publish=!1)},T=V(null),m=V([]),s=V({});N(()=>s.value.title,d=>{s.value.link=G(d)});const $=()=>{m.value.push({name:"",price:0,count:1})};$();const w=async()=>{const d=await x.post("admin/product/save",{...s.value,inventorys:m.value});d.ok&&(z.showToast("عملیات با موفقیت انجام شد!","success"),r.name=="admin_product_new"&&(await M.push({name:"admin_product_edit",params:{id:d.product.id}}),P()))},I=d=>{const l=d.target.files[0];x.uploadFile("admin/product/upload-image",l,{},u=>{console.log(u)},u=>{console.log(u),u.ok&&(s.value.image=u.dir)},u=>{})};var B=R.findPluginsByPath("product/manage");return r.name=="admin_product_new"?k.setTitle("ایجاد محصول جدید"):(k.setTitle("ویرایش محصول"),P()),(d,l)=>{const u=j("RouterLink");return a(),i("div",null,[g(O,{title:o(k).getTitle},{default:v(()=>[e("div",Y,[g(u,{to:{hash:""},role:"tab",class:y(["tab",{"tab-active tab-primary":o(r).hash==""}])},{default:v(()=>l[9]||(l[9]=[b(" اطلاعات محصول ")])),_:1,__:[9]},8,["class"]),s.value.content_type=="physical"?(a(),h(u,{key:0,to:{hash:"#inventory"},class:y([{"tab-active ":o(r).hash=="#inventory"},"tab"]),role:"tab"},{default:v(()=>l[10]||(l[10]=[b("موجودی محصول")])),_:1,__:[10]},8,["class"])):f("",!0),s.value.content_type=="media"?(a(),h(u,{key:1,to:{hash:"#courses"},class:y([{"tab-active":o(r).hash=="#courses"},"tab"]),role:"tab"},{default:v(()=>l[11]||(l[11]=[b("دوره های محصول")])),_:1,__:[11]},8,["class"])):f("",!0),(a(!0),i(C,null,U(o(B),(t,_)=>(a(),h(u,{key:_,to:{hash:"#"+t.name},class:y([{"tab-active":o(r).hash=="#"+t.name},"tab"]),role:"tab"},{default:v(()=>[b(S(t.title),1)]),_:2},1032,["to","class"]))),128))])]),_:1},8,["title"]),o(r).hash==""?(a(),i("div",Z,[e("div",ee,[e("fieldset",le,[l[12]||(l[12]=e("legend",{class:"fieldset-legend"},"عنوان محصول",-1)),n(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>s.value.title=t),class:"input input-primary w-full",type:"text",placeholder:"عنوان محصول"},null,512),[[p,s.value.title]])]),e("div",se,[e("fieldset",te,[l[13]||(l[13]=e("legend",{class:"fieldset-legend"},"لینک محصول",-1)),n(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>s.value.link=t),class:"input input-primary w-full",type:"text",placeholder:"لینک محصول"},null,512),[[p,s.value.link]])]),e("fieldset",ae,[l[15]||(l[15]=e("legend",{class:"fieldset-legend"}," نوع محتوای محصول ",-1)),n(e("select",{"onUpdate:modelValue":l[2]||(l[2]=t=>s.value.content_type=t),class:"select select-primary w-full"},l[14]||(l[14]=[e("option",{value:"physical"},"محتوای فیزیکی",-1),e("option",{value:"media"},"محتوای رسانه/ویدیو/دوره آموزشی",-1)]),512),[[D,s.value.content_type]])])]),s.value.content_type=="media"?(a(),i("div",oe,[e("fieldset",ie,[l[16]||(l[16]=e("legend",{class:"fieldset-legend"},"قیمت اصلی",-1)),n(e("input",{dir:"ltr","onUpdate:modelValue":l[3]||(l[3]=t=>s.value.price=t),class:"input input-primary w-full",type:"number",placeholder:""},null,512),[[p,s.value.price]])]),e("fieldset",ne,[l[17]||(l[17]=e("legend",{class:"fieldset-legend"},"قیمت نمایشی (برای تخفیف باید بیشتر از قیمت اصلی باشد)",-1)),n(e("input",{dir:"ltr","onUpdate:modelValue":l[4]||(l[4]=t=>s.value.show_price=t),class:"input input-primary w-full",type:"number",placeholder:""},null,512),[[p,s.value.show_price]])])])):f("",!0),e("div",null,[e("fieldset",de,[l[18]||(l[18]=e("legend",{class:"fieldset-legend"},"توضیحات کوتاه",-1)),n(e("input",{"onUpdate:modelValue":l[5]||(l[5]=t=>s.value.small_description=t),class:"input input-primary w-full",type:"text",placeholder:""},null,512),[[p,s.value.small_description]])])]),e("div",ue,[l[19]||(l[19]=e("legend",{class:"fieldset-legend"},"توضیحات",-1)),(a(),h(H,{key:s.value.id,value:s.value.description,onInput:l[6]||(l[6]=t=>s.value.description=t)},null,8,["value"]))])]),e("div",re,[e("div",pe,[e("input",{onChange:I,ref_key:"upload_main_image",ref:T,accept:".png, .jpg, .webp",type:"file",class:"hidden"},null,544),e("div",ce,[s.value.image?(a(),i("img",{key:0,class:"max-w-72 w-full h-full mx-auto rounded-lg",src:o(x).server+s.value.image,alt:""},null,8,me)):(a(),i("div",fe,[g(o(J),{class:"mx-auto size-32"})]))]),e("button",{class:"btn btn-primary mt-4",onClick:l[7]||(l[7]=t=>T.value.click())}," آپلود عکس محصول ")]),e("fieldset",ge,[e("label",ve,[n(e("input",{type:"checkbox","onUpdate:modelValue":l[8]||(l[8]=t=>s.value.publish=t),checked:s.value.publish,class:"checkbox checkbox-success"},null,8,be),[[E,s.value.publish]]),l[20]||(l[20]=b(" انتشار محصول "))])]),e("div",{class:"text-center"},[e("button",{onClick:w,class:"btn btn-success"}," ذخیره محصول ")])])])):f("",!0),o(r).hash=="#inventory"?(a(),i("div",_e,[e("div",he,[l[24]||(l[24]=e("div",{class:"text-xl font-bold"},"موجودی محصول",-1)),(a(!0),i(C,null,U(m.value,(t,_)=>(a(),i("div",xe,[e("div",ye,[e("fieldset",ke,[l[21]||(l[21]=e("legend",{class:"fieldset-legend"},"مدل/رنگ",-1)),n(e("input",{class:"color",style:{width:"40px",height:"40px","border-radius":"30px"},type:"color","onUpdate:modelValue":c=>t.color=c},null,8,we),[[p,t.color]]),n(e("input",{"onUpdate:modelValue":c=>t.name=c,class:"input input-primary w-full"},null,8,Ve),[[p,t.name]])]),e("fieldset",Ce,[l[22]||(l[22]=e("legend",{class:"fieldset-legend"},"قیمت",-1)),n(e("input",{"onUpdate:modelValue":c=>t.price=c,class:"input input-primary w-full"},null,8,Ue),[[p,t.price]])]),e("fieldset",Pe,[l[23]||(l[23]=e("legend",{class:"fieldset-legend"},"موجودی",-1)),n(e("input",{"onUpdate:modelValue":c=>t.quantity=c,class:"input input-primary w-full"},null,8,Te),[[p,t.quantity]])])]),e("div",$e,[m.value.length>1?(a(),i("button",{key:0,onClick:c=>m.value.splice(_,1),class:"cursor-pointer p-2 border-error hover:bg-error/20 duration-200 text-error rounded-lg border-1"},[g(o(W),{class:"size-6"})],8,Be)):f("",!0),_==m.value.length-1?(a(),i("button",{key:1,onClick:$,class:"cursor-pointer hover:bg-info/20 duration-200 p-2 rounded-lg border-1"},[g(o(X),{class:"size-6"})])):f("",!0)])]))),256)),e("div",{class:"text-center"},[e("button",{onClick:w,class:"btn btn-success"}," ذخیره موجودی محصول ")])])])):f("",!0),(a(!0),i(C,null,U(o(B),t=>n((a(),i("div",Se,[e("div",ze,[e("div",Me,S(t?.title),1),g(K,{variable:s.value,plugin:t},null,8,["variable","plugin"]),e("div",{class:"text-center mt-8"},[e("button",{onClick:w,class:"btn btn-success"}," ذخیره اطلاعات ")])])],512)),[[A,o(r).hash=="#"+t.name]])),256))])}}};export{je as default};
